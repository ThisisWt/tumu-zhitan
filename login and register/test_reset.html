<!DOCTYPE html>
<html lang="ch">
<head>
    <!--指定字符集-->
    <meta charset="UTF-8">
    <!--定义视口，确保页面在不同设备上现实正常-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--定义网站关键词-->
    <meta name="keywords" content="土木工程，土木智探，结构分析">
    <!--网站描述-->
    <meta name="description" content="一款用于结构分析的软件的登录与注册界面">
    <!--定义作者-->
    <meta name="author" content="软工第四小组">
    <title>密码重置</title>
    <link rel="stylesheet" href="styles_reset.css">
</head>
<body>
    <img src="https://civileng.tongji.edu.cn/_upload/tpl/03/ba/954/template954/images/logo.png">
    <h1 style="font-family:arial,simsun !important">土木智探结构密码重置界面</h1>
    <div id="main">
        <div class="title">如果您忘记密码，请重新输入新密码</div>
        <form id="resetForm" action="#" method="post" onsubmit="return enter()">
            <input type="text" name="username" id="username" placeholder="用户名"><br>
            <input type="password" name="password" id="password" placeholder="请输入您的新密码"><br>
            <input type="password" name="password_again" id="password_again" placeholder="请再次输入您的新密码"><br>
            <input type="submit" value="重置">
            <input type="reset" value="重写">
            <div class="links-container">
                <!--采用相对定位，定位在此div的右下角，在当前页面打开-->
                <a href="test_login.html" target="_self"  style="font-family:arial,simsun !important;position:relative; bottom: 0%; ">想起密码</a>
                <a href="test_register.html" target="_self"  style="font-family:arial,simsun !important;position: relative; bottom: 0%;">忘记用户名，请重新注册</a>
            </div>
        </form>
    </div>

    <script>
        function enter() {
            var username = document.getElementById("username").value;
            var password = document.getElementById("password").value;
            var passwordAgain = document.getElementById("password_again").value;

            // 发送 AJAX 请求
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'test_reset.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onload = function() {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    if (response.success) {
                        alert(response.message); // 使用弹出窗口显示成功消息
                        // 重置成功后跳转到登录界面
                        window.location.href = "test_login.html";
                    } else {
                        alert(response.message); // 使用弹出窗口显示失败消息
                    }
                }
            };
            xhr.send("username=" + username + "&password=" + password + "&password_again=" + passwordAgain);

            return false; // 阻止表单提交
        }
    </script>
</body>
</html>
